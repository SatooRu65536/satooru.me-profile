---
title: 梶研 [歩行軌跡の可視化]
category: 2023年度/4月
tags: date:2023-04-25
created_at: '2024-01-24T20:51:52+09:00'
updated_at: '2024-01-25T03:28:07+09:00'
published: true
number: 14
---

# 歩行軌跡の可視化

## 出席率
- 3年セミナー：??%

## スケジュール
### 短期的な予定
- [x] 歩行軌跡の可視化
    - [x] データを取得する
    - [x] 加速度, 角速度をグラフ化
    - [x] 歩行軌跡を表示する
    - [x] 加速度の大きさに合わせて歩幅を変えてみる

### 長期的な予定
未定  
ハッカソンに参加したい([技育キャンプ](https://talent.supporterz.jp/geekcamp/) とか)

## 進捗報告
## データを取得する
#### 使用端末等
- iPhone 12
- phyphox

### iOSアプリを制作
前回使用した phyphox は2つ以上のデータの取得ができなさそうだった  
(やり方あった)

charGPTに聞きながら作った
<img width="300" alt="app.png (126.9 kB)" src="/images/articles/14/88641e41-e6e3-4c6b-82df-cf60fa8a6dbd.webp">


結局使わなかった

### 取得方法
腰にポーチを付けてスマホを入れた  
画面(z軸)を正面に、ジャイロのx軸左回りを正  

10歩 + 左90度 + 5歩

## 加速度, 角速度をグラフ化
#### 使用言語等
- Python 3.10.10
  - pandas
  - matplotlib
  - numpy
  - signal
  - itertools

### 加速度と角速度, 角度のグラフ
<img width="1189.44" alt="output_1.png (289.0 kB)" src="/images/articles/14/7b51da46-5ab0-4937-8d4c-f10e0047899b.webp">


1歩を赤丸でプロット  
角速度を積分して角度を出した  

#### 条件
- 高さ 11m/s^2 以上
- 間隔 0.3s 以上(30サンプル)

## 歩行軌跡を表示する
### アルゴリズム
0歩の時点を (0, 0) とする  
1歩 70cm とする  
1歩進んだ時の角度(α)を出す  
α度の方向に70cm進んだ位置にプロット

### 歩行軌跡
<img width="490.32" alt="output_2.png (15.5 kB)" src="/images/articles/14/52870723-c230-47c5-9d95-670461096d78.webp">


形は想定通りだが、傾いているのが気になる  
→ 1歩踏み出した時点では腰が斜めになるから?

## 加速度の大きさに合わせて歩幅を変えてみる
5歩(歩く) + 5歩(早歩き) + 6歩(小走り)  

### 歩幅の計算
10m/s^2 : 60cm  
25m/s^2 : 100cm  
とし、一次関数として計算
> step = norm  * 0.027 + 0.33

### 歩行軌跡
<img width="893.52" alt="output_3.png (15.2 kB)" src="/images/articles/14/0e47c06d-a727-494f-ab5e-14d98903d214.webp">


分かりづらい...

#### 各歩幅(m)
> 0.648  
> 0.658  
> 0.683  
> 0.689  
> 0.709  
> 0.707  
> 0.774  
> 0.882  
> 0.875  
> 0.906  
> 0.736  
> 0.904  
> 0.929  
> 0.983  
> 0.925  
> 0.991  
> 0.816  

変化はしている  
(少数第4位以下切り捨て)

### 歩行軌跡2
<img width="322.56" alt="output_4.png (14.3 kB)" src="/images/articles/14/f7c5292b-b4f6-4cef-ba9b-a8964f2e4a4c.webp">

5歩軽く + 7歩大きく  
大袈裟にしてみた。  
> step = norm * 0.032 + 0.3

## 余談
<img width="1360" alt="bnr_sp_main01.jpg (274.3 kB)" src="/images/articles/14/b7c38e10-99eb-4515-923c-1fc9a4f9e52b.webp">

なんかすごいフェスに行くことになった

