---
title: 梶研 [端末座標系を世界座標系に]
category: 2023年度/7月
tags: date:2023-07-04
created_at: '2024-01-24T21:07:39+09:00'
updated_at: '2024-01-25T03:29:33+09:00'
published: true
number: 25
---

# 端末座標系を世界座標系に

## 出席率
- 3年セミナー：??%

## スケジュール
### 短期的な予定
- [x] 端末座標系を世界座標系に
  - [x] データをとる
  - [x] 重力に対する各軸の傾きを出す
  - [x] 2次元ベクトルを回転させる
  - [x] 3次元ベクトルを回転させる
  - [x] 端末座標系を世界座標系に変換する

### 長期的な予定
- 8/5 技育キャンプ ハッカソン
- 8/12 技育展
- 8/26 OpenHackU
- 9/2 技育キャンプ アドバンス
- 10/7,8 工科展

# 進捗報告
<img width="211" alt="assets_2.png (5.8 kB)" src="/images/articles/25/3bedc7d4-df6e-4d43-8903-ec220b80c233.webp">


## 世界座標の基準
スマホの画面(z軸正)が垂直上向の状態を世界座標の基準とする

## 端末の傾きの出し方の確認
#### 端末の傾きの計算方法
```python
roll  = math.acos(x / gravity)
pitch = math.acos(y / gravity)
yaw   = math.acos(z / gravity)
```

### z軸正が上向きの場合
- x軸: 0.0(m/s^2)
- y軸: 0.0(m/s^2)
- z軸: 9.8(m/s^2)

```text
x軸: 90.0度 (0度)
y軸: 90.0度 (0度)
z軸: 0.0度 (0度)
```
`()` 内は理想

### x軸正が上向きの場合
- x軸: 9.8(m/s^2)
- y軸: 0.0(m/s^2)
- z軸: 0.0(m/s^2)

```text
x軸: 0.0度 (0度)
y軸: 90.0度 (0度)
z軸: 90.0度 (0度)
```

### y軸正が上向きの場合
- x軸: 0.0(m/s^2)
- y軸: 9.8(m/s^2)
- z軸: 0.0(m/s^2)

```text
x軸: 90.0度 (0度)
y軸: 0.0度 (0度)
z軸: 90.0度 (0度)
```

## 計算方法の変更
この計算方法では**重力と各軸の角度**を出している  

```text
x軸(roll) : 90.0度
y軸(pitch): 90.0度
z軸(yaw)  : 0.0度
```
この状態を基準とすると
### x軸正が上向きの場合
```text
x軸(roll) : -90.0度
y軸(pitch): 0.0度
z軸(yaw)  : -90.0度
```

### y軸正が上向きの場合
```text
x軸(roll) : 90.0度
y軸(pitch): 0.0度
z軸(yaw)  : 90.0度
```

### 回転後のグラフ
<img width="605.52" alt="output_1.png (40.0 kB)" src="/images/articles/25/79f03757-df24-4bcd-b68d-25564a266ef1.webp">


### 比較
#### 元データ
<img width="605.52" alt="output_3.png (71.9 kB)" src="/images/articles/25/6746bc2c-2eab-43cf-bf0b-774b952c39c3.webp">

#### 回転後
<img width="614.88" alt="output_2.png (54.8 kB)" src="/images/articles/25/24174bd3-a723-48ad-b620-0b8ed0f15df7.webp">


動かしているときは誤差が生まれているが、
静止状態では理想的な値になっている

加速度では下方向しかとれないため、
垂直方向(今回はz軸)を軸とした回転量はわからないのでは?


## 余談
スマホを机に置いた状態で、周りをコンコン叩いた様子
右→下→左→上

なにか遊べそう
(オンラインとんとん相撲的な)

<img alt="IMG_4416.PNG (375.6 kB)" src="/images/articles/25/001c8e80-7f0a-47a4-a6be-b3b2e21814d9.webp" width="45%">

<img alt="IMG_4417.PNG (368.7 kB)" src="/images/articles/25/9f5745b4-9b70-46ab-88a4-81c1dcb47074.webp" width="45%">


